<?php

session_set_cookie_params([
    'path' => '/',
    'domain' => $_SERVER['HTTP_HOST'],
    'secure' => true,
    'httponly' => true,
    'samesite' => 'lax'
]);

function _escape_str($str)
{
    $result = str_replace("'", "''", $str);

    $replaces = ["`", "(", ")", '@', '"', "'", '%'];

    foreach($replaces as $r)
        $result = str_replace($r, "", strip_tags($result));

    return $result;
}

function validateFields($str)
{

    if (is_array($str))
    {
        foreach ($str as $key => $val)
        {
            $str[$key] = validateFields($val);
        }

        return $str;
    }

    $str = _escape_str($str);

    return $str;
}


$_POST = validateFields($_POST);
$_REQUEST = validateFields($_REQUEST);
$_GET = validateFields($_GET);