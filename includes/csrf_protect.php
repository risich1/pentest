<?php
// session_set_cookie_params([
//     // 'lifetime' => $maxlifetime,
//     'path' => $cookieConfig['path'],
//     'domain' => $cookieConfig['domain'],
//     'secure' => $cookieConfig['secure'],
//     'httponly' => $cookieConfig['httponly'],
//     'samesite' => $cookieConfig['samesite']
// ]);

ob_start(); 
session_start();

if($_SERVER['REQUEST_METHOD'] == 'GET')
    $_SESSION['token'] = bin2hex(random_bytes(35));


if($_SERVER['REQUEST_METHOD'] === 'POST')
{
    if (empty($_POST['token']) || $_SESSION['token'] !== $_POST['token']) {
        header($_SERVER['SERVER_PROTOCOL'] . ' 405 Method Not Allowed');
        exit;
    }
}   
