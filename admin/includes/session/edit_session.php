<?php

if(isset($_GET['s_id'])) {
    
    $the_session_id = $_GET['s_id'];
    
}


$query = "SELECT * FROM asu_session WHERE session_id = {$the_session_id} ";
$select_session_id = mysqli_query($connection, $query);

while($row = mysqli_fetch_assoc($select_session_id)) {
    
    $session_period = $row['session_period'];
    $session_time = $row['session_time'];
    $session_start = $row['session_start'];
    $session_end = $row['session_end'];
    
 
    if(isset($_POST['update_session'])) {
       
        $session_period = $_POST['session_period'];
        $session_time = $_POST['session_time'];
        $session_start = $_POST['session_start'];
        $session_end = $_POST['session_end'];

        
        $query = "UPDATE asu_session SET ";
        $query .= "session_period = '{$session_period}', ";
        $query .= "session_time = '{$session_time}', ";
        $query .= "session_start = '{$session_start}', ";
        $query .= "session_end = '{$session_end}' ";
        $query .= "WHERE session_id = {$the_session_id} ";
        
        $update_session = mysqli_query($connection,$query);
        
        if(!$update_session) {
        
            die("QUERY FAILED ." . mysqli_error($connection));
        
        }
        
        $message = "<div class='alert alert-success'>Сессия обновлена.</div>";
        
       
    }
    
    
}


?>


<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <h1 class="page-header">
            <i class="fa fa-id-card-o fa-fw text-muted" aria-hidden="true"></i>&nbsp;Редактировать сессию
        </h1>
    </div>
</div>  
 
<?php echo $message; ?>  
<form class="form-horizontal" action="" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <div class="col-sm-6">
            <label for="academic_plan_direction_id">
                Семестр&nbsp; 
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true" title="Обязательное поле для заполнения"></i>
            </label>
            
            <select name="session_period" class="form-control" required>
                <option value="<?php echo $session_period; ?>"><?php echo $session_period; ?></option>
                <option value="Весенний">Весенний</option>
                <option value="Осенний">Осенний</option>
            </select>
        </div>
        
        <div class="col-sm-6">
            <label for="session_time">
                Срок обучения (гггг / гггг)&nbsp; 
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true" title="Обязательное поле для заполнения"></i>
            </label>
            <input type="text" class="form-control" name="session_time" value="<?php echo $session_time; ?>" required>
        </div>
    </div>

    
    <div class="form-group">
        <div class="col-sm-6">
            <label for="session_start">
                Начало сессии&nbsp; 
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true" title="Обязательное поле для заполнения"></i>
            </label>
            <input type="date" class="form-control" name="session_start" value="<?php echo $session_start; ?>" required>
        </div>
        <div class="col-sm-6">
            <label for="session_end">
                Окончание сессии&nbsp; 
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true" title="Обязательное поле для заполнения"></i>
            </label>
            <input type="date" class="form-control" name="session_end" value="<?php echo $session_end ?>" required>
        </div>
    </div>
    
    <div class="form-group">
        <div class="col-sm-12">
            <input class="btn btn-primary" type="submit" name="update_session" value="Сохранить">
        </div>
    </div>   
    
</form>


   
   
